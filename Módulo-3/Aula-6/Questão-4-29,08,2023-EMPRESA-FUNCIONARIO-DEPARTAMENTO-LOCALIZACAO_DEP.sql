-- create a table
CREATE TABLE FUNCIONARIO (
    Pnome VARCHAR (10) NOT NULL,
    Minicial CHAR (5) NOT NULL,
    Unome VARCHAR (10) NOT NULL,
    CPF INTERGER NOT NULL,
    Datanasc VARCHAR (11) NOT NULL,
    Endereco VARCHAR (30) NOT NULL,
    Sexo CHAR(1) NOT NULL,
    Salario INTERGER NOT NULL,
    CPF_Superior INTERGER,
    Dnr INTERGER NOT NULL,
    PRIMARY KEY (CPF)
    UNIQUE (CPF)
);

-- insert some values
INSERT INTO FUNCIONARIO VALUES ("João", 'B', 'Silva', 12345678966, '09-01-1965', 'Rua das Flores, 751, São Paulo, SP', 'M', 30000, 33344555587, 5);
INSERT INTO FUNCIONARIO VALUES ("Fernando", 'T', 'Wong', 33344555587, '08-12-1955', 'Rua da Lapa, 34, São Paulo, SP', 'M', 40000, 88866555576, 5);
INSERT INTO FUNCIONARIO VALUES ("Alice", 'J', 'Zelaya', 99988777767, '19-01-1968', 'Rua Souza Lima, 35, Curitiba, PR', 'F', 25000, 98765432168, 4);
INSERT INTO FUNCIONARIO VALUES ("Jennifer", 'K', 'Souza', 98765432168, '20-06-1941', 'Rua Arthur de Lima, 54, Piracicaba, SP', 'F', 43000, 88866555576, 4);
INSERT INTO FUNCIONARIO VALUES ("Ronaldo", 'K', 'Lima', 66688444476, '15-09-1962', 'Rua Rebolças, 65, Piracicaba, SP', 'M', 38000, 33344555587, 5);
INSERT INTO FUNCIONARIO VALUES ("Joice", 'A', 'Leite', 45345345376, '31-07-1972', 'Rua Lucas Obes, 74, São Paulo, SP', 'F', 25000, 33344555587, 5);
INSERT INTO FUNCIONARIO VALUES ("André", 'V', 'Pereira', 98798798733, '29-03-1969', 'Rua Timbira, 35, São Paulo, SP', 'M', 25000, 98765432168, 4);
INSERT INTO FUNCIONARIO VALUES ("Jorge", 'E', 'Brito', 88886555576, '10-11-1937', 'Rua do Horto, 35, São Paulo, SP', 'M', 55000, NULL, 1);

-- fetch some values
--SELECT * FROM FUNCIONARIO;

-- create a table
CREATE TABLE DEPARTAMENTO (
    Dnome VARCHAR (15) NOT NULL,
    Dnumero INTERGER NOT NULL,
    Cpf_gerente INTERGER NOT NULL,
    Data_inicio_gerente VARCHAR (10) NOT NULL,
    PRIMARY KEY (Dnumero),
    FOREIGN KEY (Cpf_gerente) REFERENCES FUNCIONARIO.CPF_Superior (Cpf_gerente)
);

-- insert some values
INSERT INTO DEPARTAMENTO ('Pesquisa', 5, 33344555587, '22-05-1988');
INSERT INTO DEPARTAMENTO ('Administração', 4, 98765432168, '01-01-1995');
INSERT INTO DEPARTAMENTO ('Matriz', 1, 88866555576, '19-06-1981');

-- create a table
CREATE TABLE TRABALHA_EM (
    Fcpf INTERGER NOT NULL,
    Pnr INTERGER NOT NULL,
    Horas FLOAT (10) NOT NOT NULL,
    PRIMARY KEY (Pnr),
    FOREIGN KEY (Fcpf) REFERENCES FUNCIONARIO.CPF (Fcpf)
);

-- insert some values
INSERT INTO TRABALHA_EM (12345678966, 1, 32.5);
INSERT INTO TRABALHA_EM (12345678966, 2, 7.5);
INSERT INTO TRABALHA_EM (66688444476, 3, 40.0);
INSERT INTO TRABALHA_EM (45345345376, 1, 20.0);
INSERT INTO TRABALHA_EM (45345345376, 2, 20.0);
INSERT INTO TRABALHA_EM (33344555587, 2, 10.0);
INSERT INTO TRABALHA_EM (33344555587, 3, 10.0);
INSERT INTO TRABALHA_EM (33344555587, 10, 10.0);
INSERT INTO TRABALHA_EM (33344555587, 20, 10.0);
INSERT INTO TRABALHA_EM (99988777767, 30, 30.0);
INSERT INTO TRABALHA_EM (99988777767, 10, 10.0);
INSERT INTO TRABALHA_EM (98798798733, 10, 35.0);
INSERT INTO TRABALHA_EM (98798798733, 30, 5.0);
INSERT INTO TRABALHA_EM (98765432168, 30, 20.0);
INSERT INTO TRABALHA_EM (98765432168, 20, 15.0);
INSERT INTO TRABALHA_EM (88866555576, 20, NULL);

-- create a table
CREATE TABLE LOCALIZACAO_DEP (
    Dnumero INTERGER NOT NULL,
    Dlocal VARCHAR(10),
    PRIMARY KEY (Dlocal),
    FOREIGN KEY (Dnumero) REFERENCES DEPARTAMENTO.Dnumero (Dnumero)
);

-- insert some values
INSERT INTO LOCALIZACAO_DEP (1, 'São Paulo');
INSERT INTO LOCALIZACAO_DEP (4, 'Mauá');
INSERT INTO LOCALIZACAO_DEP (5, 'Santo André');
INSERT INTO LOCALIZACAO_DEP (5, 'Itú');
INSERT INTO LOCALIZACAO_DEP (5, 'São Paulo');

-- create a table
CREATE TABLE PROJETO (
    Projnome VARCHAR(20) NOT NULL,
    Projnumero INTERGER NOT NULL,
    Projlocal VARCHAR(10) NOT NULL,
    Dnum INTERGER NOT NULL,
    PRIMARY KEY (Projnumero),
    FOREIGN KEY (Projlocal) REFERENCES LOCALIZACAO_DEP.Dlocal (Projlocal) 
);

-- insert some values
INSERT INTO PROJETO ('ProjetoX', 1, 'Santo André', 5);
INSERT INTO PROJETO ('ProjetoY', 2, 'Itú', 5);
INSERT INTO PROJETO ('ProjetoZ', 3, 'São Paulo', 5);
INSERT INTO PROJETO ('Informatização', 10, 'Mauá', 4);
INSERT INTO PROJETO ('Reorganização', 20, 'São Paulo', 1);
INSERT INTO PROJETO ('Novosbenefícios', 30, 'Mauá', 4);

-- create a table
CREATE TABLE DEPENDENTE (
    Fcpf INTERGER NOT NULL,
    Nome_dependente VARCHAR(10) NOT NULL,
    Sexo CHAR(1) NOT NULL,
    Datanasc VARCHAR (10),
    Parentesco VARCHAR (10),
    PRIMARY KEY (Nome_dependente),
    FOREIGN KEY (Fcpf) REFERENCES FUNCIONARIO.CPF (Fcpf)
);

-- insert some values
INSERT INTO DEPENDENTE (33344555587, 'Alícia', 'F', '06-04-1986', 'Filha');
INSERT INTO DEPENDENTE (33344555587, 'Tiago', 'M', '26-10-1983', 'Filho');
INSERT INTO DEPENDENTE (33344555587, 'Janaína', 'F', '03-05-1958', 'Esposa');
INSERT INTO DEPENDENTE (98765432168, 'Antônio', 'M', '28-02-1942', 'Marido');
INSERT INTO DEPENDENTE (12345678966, 'Michael', 'M', '04-01-1968', 'Filho');
INSERT INTO DEPENDENTE (12345678966, 'Alícia', 'F', '30-12-1988', 'Filha');
INSERT INTO DEPENDENTE (12345678966, 'Elizabeth', 'F', '05-05-1967', 'Esposa');

-- Respondendo a questão:

SELECT FUNCIONARIO.Pnome, FUNCIONARIO.Unome FROM FUNCIONARIO
    JOIN TRABALHA_EM ON FUNCIONARIO.CPF = TRABALHA_EM.Fcpf
    JOIN DEPARTAMENTO ON PROJETO.Dnum = DEPARTAMENTO.Dnumero
    WHERE DEPARTAMENTO.Dnumero = 5 AND TRABALHA_EM.Horas > 10 AND PROJETO.Projnome = 'ProdutoX';


SELECT FUNCIONARIO.Pnome, FUNCIONARIO.Unome FROM FUNCIONARIO
    JOIN DEPENDENTE ON FUNCIONARIO.CPF = DEPENDENTE.Fcpf AND
    FUNCIONARIO.Pnome = DEPENDENTE.Nome_dependente


SELECT FUNCIONARIO.Pnome, FUNCIONARIO.Unome FROM FUNCIONARIO
    JOIN FUNCIONARIO Supervisor ON FUNCIONARIO.CPF_Superior = Supervisor.CPF
    WHERE Supervisor.Pnome = 'Fernando' AND Supervisor.Unome = 'Wong';


